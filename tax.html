<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<title>‡§ó‡•ç‡§∞‡§æ‡§Æ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§∏‡•á‡§§‡•Ç - Search Records</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: "Noto Sans Devanagari", Arial, sans-serif; margin:0; background:#f9f9f9; display:flex; flex-direction:column; min-height:100vh; }
header { background:linear-gradient(135deg,#8fc1e3,#c1f0d1); color:#333; padding:15px; text-align:center; position:relative; }
header h1 { margin:0; font-size:22px; }
.lang-switch { position:absolute; right:15px; top:15px; padding:5px 10px; cursor:pointer; background:#fff; border-radius:5px; border:1px solid #ccc; font-size:14px; }
footer { background:#eee; color:#333; text-align:center; padding:12px; margin-top:auto; font-size:14px; }
.container { padding:20px; flex:1; }
.search-bar { width:100%; max-width:400px; padding:10px; margin:20px auto; display:block; border-radius:8px; border:1px solid #ccc; font-size:16px; }
.user-list { max-width:600px; margin:auto; }
.user-item { background:#fff; padding:12px 15px; margin:8px 0; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); cursor:pointer; transition:0.3s ease; }
.user-item:hover { background:#e0f7fa; }
.popup { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.2); z-index:1000; overflow-y:auto; }
.popup-content { background:#fff; margin:50px auto; max-width:600px; border-radius:10px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.2); }
.popup-header { background:linear-gradient(135deg,#8fc1e3,#c1f0d1); color:#333; text-align:center; padding:20px; position:relative; }
.popup-header img { width:100px; height:100px; border-radius:50%; border:3px solid #fff; margin-bottom:10px; }
.popup-header h2 { margin:5px 0; font-size:22px; }
.popup-header h3 { margin:2px 0; font-size:16px; font-weight:normal; }
.popup-header p { margin:4px 0; font-size:15px; }
.close-btn { position:absolute; top:10px; right:10px; background:#fff; border:none; font-size:20px; padding:5px 10px; border-radius:50%; cursor:pointer; color:#333; }
.section { background:#fdfdfd; margin:15px; padding:15px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.05); }
.section h4 { margin:0 0 10px; font-size:18px; color:#333; border-bottom:1px solid #ddd; padding-bottom:5px; }
.section p { margin:6px 0; font-size:15px; }
.highlight { font-weight:bold; color:#d32f2f; font-size:16px; }
.paid-highlight { font-weight:bold; color:#388e3c; font-size:16px; }
</style>
</head>
<body>

<header>
  <h1 id="headerTitle">üåê ‡§ó‡•ç‡§∞‡§æ‡§Æ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§∏‡•á‡§§‡•Ç</h1>
  <button class="lang-switch" onclick="switchLang()">EN</button>
</header>

<div class="container">
  <input type="text" id="searchBar" class="search-bar" placeholder="üîç ‡§®‡§æ‡§µ ‡§∂‡•ã‡§ß‡§æ / Search name">
  <div class="user-list" id="userList"></div>
</div>

<div class="popup" id="popup">
  <div class="popup-content">
    <div class="popup-header">
      <button class="close-btn" onclick="closePopup()">‚úï</button>
      <img id="popupImg" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Profile">
      <h2 id="popupNameMr">‡§®‡§æ‡§Æ</h2>
      <h3 id="popupNameEn">Name</h3>
      <p id="popupWard">üè† ‡§µ‡§æ‡§∞‡•ç‡§° ‡§®‡§Ç. __, ‡§ò‡§∞ ‡§®‡§Ç. __</p>
    </div>
    <div class="section" id="demandSection">
      <h4>üîπ ‡§Æ‡§æ‡§ó‡§£‡•Ä (Demand)</h4>
      <p>‡§ò‡§∞‡§™‡•Ä ‡§ï‡§∞: <span id="dHarpi"></span></p>
      <p>‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø ‡§ï‡§∞: <span id="dArogya"></span></p>
      <p>‡§¶‡§¨‡§æ‡§¨‡•Ä ‡§ï‡§∞: <span id="dDababi"></span></p>
      <p>‡§™‡§æ‡§£‡•Ä‡§™‡§ø ‡§ï‡§∞: <span id="dPani"></span></p>
      <p>‡§™‡§°‡§∏‡§∞ ‡§ú‡§Æ‡•Ä‡§®: <span id="dPad"></span></p>
      <p>‡§¶‡§Ç‡§°: <span id="dFine"></span></p>
      <p class="highlight">‡§è‡§ï‡•Ç‡§£ ‡§Æ‡§æ‡§ó‡§£‡•Ä: <span id="dTotal"></span></p>
    </div>
    <div class="section" id="collectionSection">
      <h4>üîπ ‡§µ‡§∏‡•Å‡§≤ (Collection)</h4>
      <p>‡§¨‡•Å‡§ï: <span id="cBook"></span></p>
      <p>‡§™‡§æ‡§µ‡§§‡•Ä ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï: <span id="cReceipt"></span></p>
      <p>‡§™‡§æ‡§µ‡§§‡•Ä ‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï: <span id="cDate"></span></p>
      <p>Paid ‡§ò‡§∞‡§™‡•Ä ‡§ï‡§∞: <span id="cHarpi"></span></p>
      <p>Paid ‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø ‡§ï‡§∞: <span id="cArogya"></span></p>
      <p>Paid ‡§¶‡§¨‡§æ‡§¨‡•Ä ‡§ï‡§∞: <span id="cDababi"></span></p>
      <p>Paid ‡§™‡§æ‡§£‡•Ä‡§™‡§ø ‡§ï‡§∞: <span id="cPani"></span></p>
      <p>Paid Land Tax / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§™‡§°‡§∏‡§∞ ‡§ú‡§Æ‡•Ä‡§®: <span id="cPadLand"></span></p>
      <p>Paid Penalty / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§¶‡§Ç‡§°: <span id="cFinePaid"></span></p>
      <p>Discount / ‡§∏‡•Å‡§ü: <span id="cDiscount"></span></p>
      <p class="paid-highlight">Total Collection / ‡§è‡§ï‡•Ç‡§£ ‡§µ‡§∏‡•Å‡§≤: <span id="cTotalCollection"></span></p>
      <p>Balance / ‡§¨‡§æ‡§ï‡•Ä: <span id="cRemain"></span></p>
    </div>
  </div>
</div>

<footer>
  <p>¬© 2025 ‡§ó‡•ç‡§∞‡§æ‡§Æ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§∏‡•á‡§§‡•Ç | All Rights Reserved</p>
</footer>

<!-- PapaParse CDN -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
let lang='mr', usersData=[];
const userList=document.getElementById("userList");

function switchLang(){
  lang=(lang==='mr')?'en':'mr';
  document.getElementById('headerTitle').innerText = (lang==='mr')?"üåê ‡§ó‡•ç‡§∞‡§æ‡§Æ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§∏‡•á‡§§‡•Ç":"üåê Gram Panchayat Setu";
  document.getElementById('searchBar').placeholder=(lang==='mr')?"üîç ‡§®‡§æ‡§µ ‡§∂‡•ã‡§ß‡§æ":"üîç Search name";
  displayUsers(usersData);
}

function closePopup(){ document.getElementById("popup").style.display="none"; }

// Fetch CSV and parse using PapaParse
Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vTDCBhcg0ARlcpZqsc5KHZh6mWi3cgqS1KCtHoSVziWsCDoR0ZyxWcqkYMdWxPVCfgrj7kNSP574xVa/pub?output=csv", {
  download:true,
  header:true,
  skipEmptyLines:true,
  complete: function(results){
    usersData = results.data.map(u=>{
      u.demand={
        harpi:Number(u['House Tax / ‡§ò‡§∞‡§™‡•Ä ‡§ï‡§∞']||0),
        arogya:Number(u['Health Tax / ‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø ‡§ï‡§∞']||0),
        dababi:Number(u['Education/Other Tax / ‡§¶‡§¨‡§æ‡§¨‡•Ä ‡§ï‡§∞']||0),
        pani:Number(u['Water Tax / ‡§™‡§æ‡§£‡•Ä‡§™‡§ø ‡§ï‡§∞']||0),
        pad:Number(u['Land Tax / ‡§™‡§°‡§∏‡§∞ ‡§ú‡§Æ‡•Ä‡§®']||0),
        fine:Number(u['Penalty / ‡§¶‡§Ç‡§°']||0)
      };
      u.collection={
        book:u['Book No (‡§¨‡•Å‡§ï)']||"",
        receipt:u['Receipt No. / ‡§™‡§æ‡§µ‡§§‡•Ä ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï']||"",
        date:u['Receipt Date / ‡§™‡§æ‡§µ‡§§‡•Ä ‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï']||"",
        harpi:Number(u['Paid House Tax / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§ò‡§∞‡§™‡•Ä ‡§ï‡§∞']||0),
        arogya:Number(u['Paid Health Tax / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø ‡§ï‡§∞']||0),
        dababi:Number(u['Paid Other Tax / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§¶‡§¨‡§æ‡§¨‡•Ä ‡§ï‡§∞']||0),
        pani:Number(u['Paid Water Tax / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§™‡§æ‡§£‡•Ä‡§™‡§ø ‡§ï‡§∞']||0),
        padLand:Number(u['Paid Land Tax / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§™‡§°‡§∏‡§∞ ‡§ú‡§Æ‡•Ä‡§®']||0),
        finePaid:Number(u['Paid Penalty / ‡§≠‡§∞‡§≤‡•á‡§≤‡§æ ‡§¶‡§Ç‡§°']||0),
        sut:Number(u['Discount / ‡§∏‡•Å‡§ü']||0)
      };
      return u;
    });
    displayUsers(usersData);
  }
});

// Display users
function displayUsers(users){
  userList.innerHTML='';
  users.forEach(u=>{
    const div=document.createElement("div");
    div.className="user-item";
    div.innerText=(lang==='mr')?u['Name (Marathi) / ‡§®‡§æ‡§µ (‡§Æ‡§∞‡§æ‡§†‡•Ä)']:u['Name (English) / ‡§®‡§æ‡§µ (‡§á‡§Ç‡§ó‡•ç‡§∞‡§ú‡•Ä)'];
    div.onclick=()=>openPopup(u);
    userList.appendChild(div);
  });
}

// Search
document.getElementById('searchBar').addEventListener('input',function(){
  const q=this.value.toLowerCase();
  displayUsers(usersData.filter(u=>(lang==='mr'?u['Name (Marathi) / ‡§®‡§æ‡§µ (‡§Æ‡§∞‡§æ‡§†‡•Ä)']:u['Name (English) / ‡§®‡§æ‡§µ (‡§á‡§Ç‡§ó‡•ç‡§∞‡§ú‡•Ä)']).toLowerCase().includes(q)));
});

// Open popup
function openPopup(u){
  document.getElementById("popup").style.display="block";
  document.getElementById("popupImg").src="https://cdn-icons-png.flaticon.com/512/149/149071.png";
  document.getElementById("popupNameMr").innerText=u['Name (Marathi) / ‡§®‡§æ‡§µ (‡§Æ‡§∞‡§æ‡§†‡•Ä)'];
  document.getElementById("popupNameEn").innerText=u['Name (English) / ‡§®‡§æ‡§µ (‡§á‡§Ç‡§ó‡•ç‡§∞‡§ú‡•Ä)'];
  document.getElementById("popupWard").innerText=`üè† ‡§µ‡§æ‡§∞‡•ç‡§° ‡§®‡§Ç. ${u['Ward No. / ‡§µ‡§æ‡§∞‡•ç‡§° ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï']}, ‡§ò‡§∞ ‡§®‡§Ç. ${u['House No. / ‡§ò‡§∞ ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï']}`;

  let d=u.demand;
  document.getElementById("dHarpi").innerText=d.harpi;
  document.getElementById("dArogya").innerText=d.arogya;
  document.getElementById("dDababi").innerText=d.dababi;
  document.getElementById("dPani").innerText=d.pani;
  document.getElementById("dPad").innerText=d.pad;
  document.getElementById("dFine").innerText=d.fine;
  document.getElementById("dTotal").innerText=d.harpi+d.arogya+d.dababi+d.pani+d.pad+d.fine;

  let c=u.collection;
  document.getElementById("cBook").innerText=c.book;
  document.getElementById("cReceipt").innerText=c.receipt;
  document.getElementById("cDate").innerText=c.date;
  document.getElementById("cHarpi").innerText=c.harpi;
  document.getElementById("cArogya").innerText=c.arogya;
  document.getElementById("cDababi").innerText=c.dababi;
  document.getElementById("cPani").innerText=c.pani;
  document.getElementById("cPadLand").innerText=c.padLand;
  document.getElementById("cFinePaid").innerText=c.finePaid;
  document.getElementById("cDiscount").innerText=c.sut;
  document.getElementById("cTotalCollection").innerText=c.harpi+c.arogya+c.dababi+c.pani+c.padLand+c.finePaid-c.sut;
  document.getElementById("cRemain").innerText=(d.harpi+d.arogya+d.dababi+d.pani+d.pad+d.fine)-(c.harpi+c.arogya+c.dababi+c.pani+c.padLand+c.finePaid-c.sut);
}
</script>
</body>
</html>
